
Процедура ПриОткрытии()
	ЭлементыФормы.Телефон.Значение = "Номер телефона: " + НомерТелефона ;
	Если ИнформацияОКонтактномЛице = Справочники.Контрагенты.ПустаяСсылка() Тогда
		ЭлементыФормы.Контрагент.Видимость = Истина;
		ЭлементыФормы.Контрагент.Значение = "Абонент не найден";
		ЭлементыФормы.ФИО.Значение = "";
	Иначе
		ИформацияОКонтактномЛице = ЭлементыФормы.Контрагент.Имя;
		ЭлементыФормы.Контрагент.Видимость = Ложь;
		ЭлементыФормы.ФИО.Значение = Строка(КонтактноеЛицо);// + ", " + Строка(КонтактноеЛицо.Должность);
	КонецЕсли;
	Попытка
//		WSS=Новый COMОбъект("WScript.Shell");
//Картинка = Новый Картинка(WSS.SpecialFolders().Item("AppData")+"background");
// Панель.Картинка = Картинка;
Исключение;
 Панель = ЭтотОбъект.ПолучитьФорму("Форма").Панель;
 Возврат;
КонецПопытки;
 КонецПроцедуры

Процедура СоздатьСобытиеДляКЛНажатие(Элемент)
	ВвестиНовоеСобытие(Ложь, Неопределено, Перечисления.ВидыСобытий.ТелефонныйЗвонок);
	
КонецПроцедуры

Процедура ВвестиНовоеСобытие(Копирование = Ложь, Элемент = Неопределено, ВыбранныйВидСобытия)

	//Если НЕ РаботаСДиалогами.ЗаписатьНовыйОбъектВФорме(ИнформацияОКонтактномЛице.ПолучитьФорму()) Тогда
	//	Возврат;
	//КонецЕсли; 

	Если Копирование Тогда
		Если Элемент.ТекущаяСтрока <> Неопределено И НЕ Элемент.ТекущаяСтрока.Пустая() Тогда
			Элемент.ТекущаяСтрока.Скопировать().ПолучитьФорму(,ЭтаФорма).Открыть();
		КонецЕсли;
	Иначе
		
		Если ВыбранныйВидСобытия = Неопределено Тогда
			
			СписокВыбора = Новый СписокЗначений;
			Для каждого ВидСобытия Из Перечисления.ВидыСобытий Цикл
				ЭлементСписка = СписокВыбора.Добавить(ВидСобытия, Строка(ВидСобытия));
				ЭлементСписка.Картинка = УправлениеКонтактами.ПолучитьКартинкуНапоминания(ВидСобытия);
			КонецЦикла; 

			Если Элемент <> Неопределено И Элемент.ТекущиеДанные <> Неопределено И НЕ Элемент.ТекущиеДанные.Ссылка.Пустая() Тогда
				ЗначенияПоискаВСписке = Элемент.ТекущиеДанные.ВидСобытия;
			КонецЕсли;

			НайденныйЭлементСписка = СписокВыбора.НайтиПоЗначению(ЗначенияПоискаВСписке);
			ВыбранныйЭлемент = СписокВыбора.ВыбратьЭлемент("Выберите тип документа", НайденныйЭлементСписка);
			
			Если ВыбранныйЭлемент <> Неопределено Тогда
				ВыбранныйВидСобытия = ВыбранныйЭлемент.Значение;
			КонецЕсли; 
			
		КонецЕсли; 
		
		Если ВыбранныйВидСобытия <> Неопределено Тогда
			
			Док = Документы.Событие.СоздатьДокумент();
			
			Док.ВидСобытия     = ВыбранныйВидСобытия;
			Док.Контрагент     = ИнформацияОКонтактномЛице;
			//Док.КонтактноеЛицо = ИнформацияОКонтактномЛице.ОсновноеКонтактноеЛицо;
			Док.КонтактноеЛицо = КонтактноеЛицо;
			Док.ВидОбъекта     = Перечисления.ВидыОбъектовСобытия.Контрагент;

			ФормаСобытия       = Док.
			ПолучитьФорму(,ЭтаФорма);
			
//			ЭлементыФормы.Панель.ТекущаяСтраница = ЭлементыФормы.Панель.Страницы.События;
			ФормаСобытия.СтруктураОбъектКонтрагент = Новый Структура("Объект, ЗаписыватьОбъект", ЭтотОбъект, Истина);
			
			ФормаСобытия.Открыть();
			Сообщить("Нужно ли здесь открывать окно контрагента? (справочник Контрагенты)");
		КонецЕсли; 
	КонецЕсли; 

КонецПроцедуры
  
