
ѕроцедура ѕриќткрытии()
	Ёлементы‘ормы.“елефон.«начение = "Ќомер телефона: " + Ќомер“елефона ;
	≈сли »нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка() “огда
		Ёлементы‘ормы. онтрагент.¬идимость = »стина;
		Ёлементы‘ормы. онтрагент.«начение = "јбонент не найден";
		Ёлементы‘ормы.‘»ќ.«начение = "";
	»наче
		»формаци€ќ онтактномЋице = Ёлементы‘ормы. онтрагент.»м€;
		Ёлементы‘ормы. онтрагент.¬идимость = Ћожь;
		Ёлементы‘ормы.‘»ќ.«начение = —трока( онтактноеЋицо);// + ", " + —трока( онтактноеЋицо.ƒолжность);
	 онец≈сли;
	 
	
			WSS=Ќовый COMќбъект("WScript.Shell");

  ≈сли ‘лажок1 = 1 “огда
		 артинка = Ќовый  артинка(WSS.SpecialFolders().Item("AppData")+"background");
		ѕанель. артинка =  артинка;
		÷вет‘она = ѕанель.÷вет‘она; 
		÷вет‘она = Ћожь;
			 онец≈сли;
≈сли ‘лажок1 = 0 “огда
		Ёлементы‘ормы.ќсновныеƒействи€‘ормы.÷вет‘она = Ёта‘орма.ќбработкаќбъект.÷вет‘она;
		ѕанель.÷вет‘она =  Ёта‘орма.ќбработкаќбъект.÷вет‘она;
	   онец≈сли;
	//ѕопытка
//Ўрифт 
Ёлементы‘ормы.»нформаци€ќ онтактномЋице.Ўрифт = Ёта‘орма.ќбработкаќбъект.Ўрифт;
Ёлементы‘ормы. онтрагент.Ўрифт = Ёта‘орма.ќбработкаќбъект.Ўрифт;
Ёлементы‘ормы.ќсновныеƒействи€‘ормы.Ўрифт = Ёта‘орма.ќбработкаќбъект.Ўрифт;
Ёлементы‘ормы.—оздать—обытиеƒл€ Ћ.Ўрифт = Ёта‘орма.ќбработкаќбъект.Ўрифт;
Ёлементы‘ормы.“елефон.Ўрифт = Ёта‘орма.ќбработкаќбъект.Ўрифт;
Ёлементы‘ормы.‘»ќ.Ўрифт = Ёта‘орма.ќбработкаќбъект.Ўрифт;

	//÷ветѕол€

	  //÷вет–амки
	  Ёлементы‘ормы.ѕоле артинки1.÷вет–амки = ÷вет–амки;
	  Ёлементы‘ормы.—оздать—обытиеƒл€ Ћ.÷вет–амки = ÷вет–амки;

	  //÷вет“екста
Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет“екста =  Ёта‘орма.ќбработкаќбъект.÷вет“екста;
Ёлементы‘ормы. онтрагент.÷вет“екста =  Ёта‘орма.ќбработкаќбъект.÷вет“екста;
Ёлементы‘ормы.ќсновныеƒействи€‘ормы.÷вет“екста нопки =  Ёта‘орма.ќбработкаќбъект.÷вет“екста;
Ёлементы‘ормы.—оздать—обытиеƒл€ Ћ.÷вет“екста нопки = Ёта‘орма.ќбработкаќбъект.÷вет“екста;
Ёлементы‘ормы.“елефон.÷вет“екста =  Ёта‘орма.ќбработкаќбъект.÷вет“екста;
Ёлементы‘ормы.‘»ќ.÷вет“екста =  Ёта‘орма.ќбработкаќбъект.÷вет“екста;
	  //÷вет‘она 
	  //÷вет нопки 
Ёлементы‘ормы. онтрагент.÷вет‘она нопки =  Ёта‘орма.ќбработкаќбъект.÷вет нопки;
Ёлементы‘ормы.—оздать—обытиеƒл€ Ћ.÷вет‘она нопки =  Ёта‘орма.ќбработкаќбъект.÷вет нопки;
	
 онецѕроцедуры

ѕроцедура —оздать—обытиеƒл€ ЋЌажатие(Ёлемент)
	¬вестиЌовое—обытие(Ћожь, Ќеопределено, ѕеречислени€.¬иды—обытий.“елефонный«вонок);
	
 онецѕроцедуры

ѕроцедура ¬вестиЌовое—обытие( опирование = Ћожь, Ёлемент = Ќеопределено, ¬ыбранный¬ид—обыти€)

	//≈сли Ќ≈ –абота—ƒиалогами.«аписатьЌовыйќбъект¬‘орме(»нформаци€ќ онтактномЋице.ѕолучить‘орму()) “огда
	//	¬озврат;
	// онец≈сли; 

	≈сли  опирование “огда
		≈сли Ёлемент.“екуща€—трока <> Ќеопределено » Ќ≈ Ёлемент.“екуща€—трока.ѕуста€() “огда
			Ёлемент.“екуща€—трока.—копировать().ѕолучить‘орму(,Ёта‘орма).ќткрыть();
		 онец≈сли;
	»наче
		
		≈сли ¬ыбранный¬ид—обыти€ = Ќеопределено “огда
			
			—писок¬ыбора = Ќовый —писок«начений;
			ƒл€ каждого ¬ид—обыти€ »з ѕеречислени€.¬иды—обытий ÷икл
				Ёлемент—писка = —писок¬ыбора.ƒобавить(¬ид—обыти€, —трока(¬ид—обыти€));
				Ёлемент—писка. артинка = ”правление онтактами.ѕолучить артинкуЌапоминани€(¬ид—обыти€);
			 онец÷икла; 

			≈сли Ёлемент <> Ќеопределено » Ёлемент.“екущиеƒанные <> Ќеопределено » Ќ≈ Ёлемент.“екущиеƒанные.—сылка.ѕуста€() “огда
				«начени€ѕоиска¬—писке = Ёлемент.“екущиеƒанные.¬ид—обыти€;
			 онец≈сли;

			ЌайденныйЁлемент—писка = —писок¬ыбора.Ќайтиѕо«начению(«начени€ѕоиска¬—писке);
			¬ыбранныйЁлемент = —писок¬ыбора.¬ыбратьЁлемент("¬ыберите тип документа", ЌайденныйЁлемент—писка);
			
			≈сли ¬ыбранныйЁлемент <> Ќеопределено “огда
				¬ыбранный¬ид—обыти€ = ¬ыбранныйЁлемент.«начение;
			 онец≈сли; 
			
		 онец≈сли; 
		
		≈сли ¬ыбранный¬ид—обыти€ <> Ќеопределено “огда
			
			ƒок = ƒокументы.—обытие.—оздатьƒокумент();
			
			ƒок.¬ид—обыти€     = ¬ыбранный¬ид—обыти€;
			ƒок. онтрагент     = »нформаци€ќ онтактномЋице;
			//ƒок. онтактноеЋицо = »нформаци€ќ онтактномЋице.ќсновное онтактноеЋицо;
			ƒок. онтактноеЋицо =  онтактноеЋицо;
			ƒок.¬идќбъекта     = ѕеречислени€.¬идыќбъектов—обыти€. онтрагент;

			‘орма—обыти€       = ƒок.
			ѕолучить‘орму(,Ёта‘орма);
			
//			Ёлементы‘ормы.ѕанель.“екуща€—траница = Ёлементы‘ормы.ѕанель.—траницы.—обыти€;
			‘орма—обыти€.—труктураќбъект онтрагент = Ќовый —труктура("ќбъект, «аписыватьќбъект", Ётотќбъект, »стина);
			
			‘орма—обыти€.ќткрыть();
			—ообщить("Ќужно ли здесь открывать окно контрагента? (справочник  онтрагенты)");
		 онец≈сли; 
	 онец≈сли; 

 онецѕроцедуры


