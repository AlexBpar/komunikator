ѕерем XMLHttp;


ѕроцедура —охранитьЌажатие(Ёлемент)
	
	“екст = Ќовый “екстовыйƒокумент();
	“екст.ƒобавить—троку(¬нутреннийЌомер);
	“екст.ƒобавить—троку(ѕароль);	
	“екст.ƒобавить—троку(—ервер) ;
	WSS=Ќовый COMќбъект("WScript.Shell");
	—ообщить(WSS.SpecialFolders().Item("AppData"));
	“екст.«аписать(WSS.SpecialFolders().Item("AppData")+"PersonalDetails");
	
	ѕользователь = ѕараметры—еанса.“екущийѕользователь.ѕолучитьќбъект();
	ѕользователь.«аписать();
	
	јвторизаци€();
	   	
 онецѕроцедуры                   

ѕроцедура ѕозвонитьЌажатие()
	
	 —сылка ="http://"  + —окрЋѕ(—ервер)+"//service/data.php?action=make_call&session="+—окрЋѕ(—есси€)+"&number="+—окрЋѕ(Ќомер“елефона);
	 —ообщить(—сылка);
	 XMLHttp.Open("GET", —сылка, False);
	 XMLHttp.Send();
	 ќтвет—ервера = XMLHttp.responseText;
	 —ообщить(ќтвет—ервера);
	 ≈сли Ќайти(ќтвет—ервера,"true") > 0 “огда
		 —ообщить("ѕодключились");
		 //Ќомер“елефона = —окрЋѕ(—ред(ќтвет—ервера,Ќайти(ќтвет—ервера,"number")+6));
		 //ѕоискјбонента(—окрЋѕ(Ќомер“елефона));
	 »наче≈сли  Ќайти(ќтвет—ервера,"false") > 0 “огда
		 —ообщить(—ред(ќтвет—ервера,28,—трƒлина(ќтвет—ервера)-30));
	  онец≈сли;
	 
		 
  онецѕроцедуры

ѕроцедура ЌайтиЌажатие(Ёлемент)   //ѕоиск по введенной строке
	≈сли Ќе —трокаѕоиска ="" тогда
	 
	–езультатѕоиска—писок.ќчистить();
	—писокЌомеров онтактногоЋица.ќчистить();
	Ќомер“елефона = "";
		
	«апросѕоиска = Ќовый «апрос;
	«апросѕоиска.“екст = "¬џЅ–ј“№
	                     |	 онтактна€»нформаци€.ќбъект
	                     |»«
	                     |	–егистр—ведений. онтактна€»нформаци€  ј   онтактна€»нформаци€
	                     |√ƒ≈
	                     | онтактна€»нформаци€.ѕредставление ѕќƒќЅЌќ &Ќаименование";
	//«апросѕоиска.”становитьѕараметр("Ќаименование",—окрЋѕ(—трокаѕоиска));
	«апросѕоиска.”становитьѕараметр("Ќаименование","%"+—окрЋѕ(—трокаѕоиска)+"%");
	–езультат«апроса = «апросѕоиска.¬ыполнить().¬ыгрузить();
	≈сли –езультат«апроса. оличество() <> 0 “огда
		ƒл€ каждого —трока »з –езультат«апроса ÷икл
			Ќов = –езультатѕоиска—писок.ƒобавить();
			Ќов.ќбъект= —трока.ќбъект;
		
		 онец÷икла;
		
		 	»наче —ообщить("ѕо номеру "+—трокаѕоиска+" ничего не найдено!");
		—писокЌомеров онтактногоЋица.ќчистить();
		//–езультатѕоиска—писок = "";
		—трокаѕоиска = "";
		Ќомер“елефона = "";
		»нформаци€ќ онтактномЋице = "";
	 онец≈сли;
		
  онец≈сли;

		
 онецѕроцедуры

ѕроцедура ѕриќткрытии()
	//ищем текстовик с персональными данными
	ѕользователь— = ѕараметры—еанса.“екущийѕользователь;
	WSS=Ќовый COMќбъект("WScript.Shell");
	ѕопытка
		
	  //логин, пароль, сервер берем из текстовика
	“екст = Ќовый “екстовыйƒокумент();
	“екст.ѕрочитать(WSS.SpecialFolders().Item("AppData")+"PersonalDetails");
	—тр = “екст.ѕолучить—троку(1);
	¬нутреннийЌомер = —тр;
	—тр2 = “екст.ѕолучить—троку(2);
	ѕароль = —тр2;
	—тр3 = “екст.ѕолучить—троку(3);
	—ервер = —тр3;	
»сключение  


	   Ёта‘орма.ѕанель.“екуща€—траница = Ёта‘орма.ѕанель.—траницы.Ќастройки;
	   –ежим = –ежимƒиалога¬опрос.ќ ;
	   ќтвет = ¬опрос("Ќеобходимо заполнить настройки подключени€!",–ежим,,,"ќшибка соединени€");  
		  ≈сли ќтвет =  од¬озвратаƒиалога.ќ  “огда
			  ¬нутреннийЌомер = "";
			  ѕароль = "";
			  —ервер = "";
			  ¬озврат;
				
   		   онец≈сли;

        ¬озврат;
     онецѕопытки;	
	  
	≈сли “аймаут—екунд = 0 “огда
		“аймаут—екунд = 5;
	 онец≈сли;
	“айм = 0;
	ѕользователь— = ѕараметры—еанса.“екущийѕользователь;
	ѕользователь = ѕараметры—еанса.“екущийѕользователь;
	
//≈сли дл€ фона формы уже выбрана картинка, используетс€ последн€€ выбранна€ картинка	
ѕопытка
	≈сли ‘лажок1 = 1 “огда
		 артинка = Ќовый  артинка(WSS.SpecialFolders().Item("AppData")+"background");
		ѕанель. артинка =  артинка;
		÷вет‘она = ѕанель.÷вет‘она; 
		÷вет‘она = Ћожь;
	 онец≈сли;
	≈сли ‘лажок1= 0 “огда
		ѕанель.÷вет‘она = ¬осстановить«начение("÷вет‘она");	
		Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки =  ¬осстановить«начение("÷вет‘она");
		Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ =  ¬осстановить«начение("÷вет‘она");
		Ёлементы‘ормы.ƒействи€‘ормы.÷вет‘она = ¬осстановить«начение("÷вет‘она");

	 онец≈сли;
	
»сключение;
	¬озврат;
 онецѕопытки;
//	
    

		  
	≈сли —окрЋѕ(—ервер) <> "" » —окрЋѕ(ѕароль) <> "" » —окрЋѕ(¬нутреннийЌомер)<> "" “огда
		ќбновитьƒанныеќ онтактномЋице(—правочники. онтрагенты.ѕуста€—сылка());
		јвторизаци€();
		ѕодключитьќбработчикќжидани€("—осто€ниеѕриема", “аймаут—екунд); 
		
	»наче 
		Ёта‘орма.ѕанель.“екуща€—траница = Ёта‘орма.ѕанель.—траницы.Ќастройки;
		—ообщить("«аполните настройки подключени€.");
		
	 онец≈сли;
	
	ѕопытка
		//восстановить цвет кнопок
		 Ёлементы‘ормы.Ќомер“елефона.÷вет‘она нопки =  ¬осстановить«начение("¬ыбранный÷вет1");
	   Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет‘она нопки = ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет‘онаЎапки=¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы. онтрагент.÷вет‘она нопки = ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы. онтактноеЋицо.÷вет‘она нопки =  ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.—оздать—обытие.÷вет‘она нопки = ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет‘онаЎапки = ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.—трокаѕоиска.÷вет‘она нопки =  ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.Ќайти.÷вет‘она нопки =  ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.÷вет‘она.÷вет‘она нопки =  ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.÷вет“екста.÷вет‘она нопки = ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.÷вет–амки.÷вет‘она нопки =   ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.÷вет нопки.÷вет‘она нопки= ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.—охранить.÷вет‘она нопки =   ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.ѕоле“екста.÷вет‘она нопки =  ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.Ўрифт.÷вет‘она нопки =  ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.ѕозвонить.÷вет‘она нопки =  ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы. артинка‘она.÷вет‘она нопки = ¬осстановить«начение("¬ыбранный÷вет1");
   Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки = ¬осстановить«начение("¬ыбранный÷вет1");

   
   
    Ёлементы‘ормы.Ќомер“елефона.÷вет‘онаѕол€ = ¬осстановить«начение("ѕоле“екста");
	Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет‘онаѕол€ = ¬осстановить«начение("ѕоле“екста");
	Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет‘онаѕол€ = ¬осстановить«начение("ѕоле“екста");
	Ёлементы‘ормы.–езультатѕоиска—писок.÷вет‘онаѕол€ =¬осстановить«начение("ѕоле“екста");
	Ёлементы‘ормы.¬нутреннийЌомер.÷вет‘онаѕол€ = ¬осстановить«начение("ѕоле“екста");
	Ёлементы‘ормы.ѕароль.÷вет‘онаѕол€ = ¬осстановить«начение("ѕоле“екста");
	Ёлементы‘ормы.—ервер.÷вет‘онаѕол€ =   ¬осстановить«начение("ѕоле“екста");
	Ёлементы‘ормы.“аймаут—екунд.÷вет‘онаѕол€ =   ¬осстановить«начение("ѕоле“екста");
	Ёлементы‘ормы.—трокаѕоиска.÷вет‘онаѕол€ =  ¬осстановить«начение("ѕоле“екста");
    Ёлементы‘ормы.ѕользователь—.÷вет‘онаѕол€ = ¬осстановить«начение("ѕоле“екста");
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ = ¬осстановить«начение("ѕоле“екста");


		
	 //¬осстанавливаем значение настроек текста телефонии
Ёлементы‘ормы.¬нутреннийЌомер.÷вет“екстаѕол€= ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет“екстаѕол€= ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.÷вет“екста.÷вет“екста нопки =     ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.Ќадпись¬нутреннийЌомер.÷вет“екста=  ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.Ќадпись»нформаци€ќ онтактномЋице.÷вет“екста=  ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.ЌадписьЌомер“елефона.÷вет“екста= ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.Ќадписьѕароль.÷вет“екста =  ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.Ќадпись—ервер.÷вет“екста=¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.Ќадпись“аймаут.÷вет“екста=  ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.Ќайти.÷вет“екста нопки= ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.Ќомер“елефона.÷вет“екстаѕол€=¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.ѕароль.÷вет“екстаѕол€ =¬осстановить«начение("¬ыбранный÷вет"); 
Ёлементы‘ормы.ѕозвонить.÷вет“екста нопки=  ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.ѕоле алендар€1.÷вет“екстаѕол€=   ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.ѕользователь—.÷вет“екстаѕол€=¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.–езультатѕоиска—писок.÷вет“екстаѕол€= ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.сек.÷вет“екста=  ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.—ервер.÷вет“екстаѕол€ =¬осстановить«начение("¬ыбранный÷вет"); 
Ёлементы‘ормы.—оздать—обытие.÷вет“екста нопки=  ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.—охранить.÷вет“екста нопки=  ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет“екстаѕол€= ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.—трокаѕоиска.÷вет“екстаѕол€=¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.“аймаут—екунд.÷вет“екстаѕол€= ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.÷вет‘она.÷вет“екста нопки =¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.÷вет–амки.÷вет“екста нопки = ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.Ўрифт.÷вет“екста нопки = ¬осстановить«начение("¬ыбранный÷вет"); 
Ёлементы‘ормы.ƒействи€‘ормы.÷вет“екста нопки =  ¬осстановить«начение("¬ыбранный÷вет");
ѕанель.÷вет“екста =¬осстановить«начение("¬ыбранный÷вет");
ѕанель.÷вет“екстаѕол€ = ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы. онтактноеЋицо.÷вет“екста нопки = ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы. онтрагент.÷вет“екста нопки = ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы. артинка‘она.÷вет“екста нопки =¬осстановить«начение("¬ыбранный÷вет"); 
Ёлементы‘ормы.‘лажок1.÷вет“екста =   ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет“екстаЎапки=¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.–езультатѕоиска—писок.÷вет“екстаЎапки = ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.ѕоле алендар€1.÷вет“екста нопки = ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.÷вет нопки.÷вет“екста нопки =  ¬осстановить«начение("¬ыбранный÷вет");
Ёлементы‘ормы.‘лажок1.÷вет“екста = ¬осстановить«начение ("¬ыбранный÷вет");
Ёлементы‘ормы.Ќастройка÷вета.÷вет“екста = ¬осстановить«начение ("¬ыбранный÷вет");
Ёлементы‘ормы.ѕоле“екста.÷вет“екста нопки = ¬осстановить«начение ("¬ыбранный÷вет");
Ёлементы‘ормы.Ќадп—оздать.÷вет“екста = ¬осстановить«начение ("¬ыбранный÷вет");

	  
	  
	  
	  //восстановить значение цвета рамок
Ёлементы‘ормы.¬нутреннийЌомер.÷вет–амки= ¬осстановить«начение("÷вет–амки");
Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет–амки= ¬осстановить«начение("÷вет–амки");
Ёлементы‘ормы.Ќомер“елефона.÷вет–амки=  ¬осстановить«начение("÷вет–амки");
Ёлементы‘ормы.ѕароль.÷вет–амки = ¬осстановить«начение("÷вет–амки"); 
Ёлементы‘ормы.–езультатѕоиска—писок.÷вет–амки=  ¬осстановить«начение("÷вет–амки");
Ёлементы‘ормы.—ервер.÷вет–амки = ¬осстановить«начение("÷вет–амки");
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет–амки=  ¬осстановить«начение("÷вет–амки");
Ёлементы‘ормы.—трокаѕоиска.÷вет–амки= ¬осстановить«начение("÷вет–амки");
Ёлементы‘ормы.“аймаут—екунд.÷вет–амки=  ¬осстановить«начение("÷вет–амки");
ѕанель.÷вет–амки=  ¬осстановить«начение("÷вет–амки");
Ёлементы‘ормы.–амка√руппы1.÷вет–амки = ¬осстановить«начение("÷вет–амки");
Ёлементы‘ормы.–амка√руппы2.÷вет–амки = ¬осстановить«начение("÷вет–амки");


//восстановить значение выбранного шрифта текста
Ёлементы‘ормы.Ќадп—оздать.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.¬нутреннийЌомер.Ўрифт= ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.ƒействи€‘ормы.Ўрифт= ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.»нформаци€ќ онтактномЋице.Ўрифт=  ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.Ќадпись¬нутреннийЌомер.Ўрифт =   ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.Ќадпись»нформаци€ќ онтактномЋице.Ўрифт=   ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.ЌадписьЌомер“елефона.Ўрифт =    ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.Ќадписьѕароль.Ўрифт =     ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.Ќадпись—ервер.Ўрифт =   ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.Ќадпись“аймаут.Ўрифт =   ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.Ќомер“елефона.Ўрифт =   ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.ќсновныеƒействи€‘ормы.Ўрифт =  ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.ѕароль.Ўрифт =    ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.ѕозвонить.Ўрифт =    ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.ѕоле алендар€1.Ўрифт =   ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.ѕользователь—.Ўрифт =     ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.–езультатѕоиска—писок.Ўрифт =  ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.сек.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.—ервер.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.—оздать—обытие.Ўрифт =   ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.—охранить.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.Ўрифт =  ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.—трокаѕоиска.Ўрифт =   ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.“аймаут—екунд.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.÷вет‘она.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.÷вет–амки.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.÷вет“екста.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.Ўрифт.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.Ќайти.Ўрифт =  ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы. онтрагент.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы. онтактноеЋицо.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы. артинка‘она.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.‘лажок1.Ўрифт =¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.–езультатѕоиска—писок.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.÷вет нопки.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт");
Ёлементы‘ормы.‘лажок1.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт"); 
 Ёлементы‘ормы.Ќастройка÷вета.Ўрифт = ¬осстановить«начение("¬ыбранныйЎрифт"); 
Ёлементы‘ормы.ѕоле“екста.Ўрифт= ¬осстановить«начение("¬ыбранныйЎрифт");  
»сключение;
¬озврат;
 онецѕопытки;



// восстановить значение пол€
   онецѕроцедуры

‘ункци€ Ќайти„исло¬—троке(—трока—Ќомером“елефона)
	—трока„исел = "";
	ƒл€ »ндекс = 1 ѕо —трƒлина(—трока—Ќомером“елефона) ÷икл
		—имвол = —ред(—трока—Ќомером“елефона, »ндекс, 1); //ѕеребираем все символы в строке с телефоном
		≈сли  од—имвола(—имвол) >= 48 »  од—имвола(—имвол) <= 57 “огда // код "0"=48, "9"=57
			—трока„исел = —трока„исел + —имвол;
		 онец≈сли;
	 онец÷икла;
	
	¬озврат —трока„исел;
 онец‘ункции

ѕроцедура јвторизаци€()
    —сылка = "http://"  + —окрЋѕ(—ервер)+"//service/data.php?action=auth&extension="+—окрЋѕ(¬нутреннийЌомер)+"&password="+—окрЋѕ(ѕароль);
    —ообщить(—сылка);
	XMLHttp = GetCOMObject("", "Microsoft.XMLHTTP");
	XMLHttp.Open("GET", —сылка, False);
	XMLHttp.Send();
	ќтвет—ервера = XMLHttp.responseText;
		
	–езультатћассив = —трока¬ћассив(ќтвет—ервера,);
	ћо€—труктура = Ќовый —труктура("ƒоступ","—есси€");
    ƒл€ каждого Ёлементћассива »з –езультатћассив ÷икл
      Ёлемент = —тр«аменить(Ёлементћассива, """","");
	  Ёлемент = —тр«аменить(Ёлемент, "{","");
	 	  ≈сли Ќайти(Ёлемент,"true") > 0 “огда
	      ћо€—труктура.¬ставить("ƒоступ", "true");
      »наче≈сли Ќайти(Ёлемент,"false") > 0 “огда
		  ћо€—труктура.¬ставить("ƒоступ", "false");
		  –ежим = –ежимƒиалога¬опрос.ќ ;
		  ќтвет = ¬опрос("ѕроверьте наличие и правильность номера и парол€!!!",–ежим,,,"ќшибка соединени€");  
		  ≈сли ќтвет =  од¬озвратаƒиалога.ќ  “огда
			  ¬озврат;
		   онец≈сли;
		  
			  
      »наче≈сли Ќайти(Ёлемент,"session_id") > 0 “огда
		  «начение = Ћев(—тр«аменить(Ёлемент, "session_id:",""),—трƒлина(—тр«аменить(Ёлемент, "session_id:","")));
		  ћо€—труктура.¬ставить("—есси€",«начение);
		  —есси€ = «начение;
		  //—ообщить(—есси€);
		  //—осто€ниеѕриема();
		 
	   онец≈сли;
      
     онец÷икла;
	
 онецѕроцедуры

‘ункци€ —трока¬ћассив(«нач «начение, –азделитель = ",") Ёкспорт
        ћн—тр = —тр«аменить( «начение, –азделитель, —имволы.ѕ—);
        –езультатћассив = Ќовый ћассив;
		ƒл€ й = 1 ѕо —тр„исло—трок(ћн—тр) ÷икл
            –езультатћассив.ƒобавить(—трѕолучить—троку(ћн—тр,й));
         онец÷икла;
        ¬озврат –езультатћассив;
	 онец‘ункции

ѕроцедура —осто€ниеѕриема()
	—сылка = "http://" + —окрЋѕ(—ервер)+"//service/data.php?action=get_state&session="+—окрЋѕ(—есси€);
	
	 XMLHttp.Open("GET", —сылка, False);
	 XMLHttp.Send();
	 ќтвет—ервера = XMLHttp.responseText;
	 //
 	//ќтвет—ервера = "success:true,status:online,incoming_call:{time:01.01.12 12:00:00,number:000}"; 
 	//
 	≈сли Ќайти(ќтвет—ервера,"incoming_call") > 0 “огда
    	 –езультатћассив = —трока¬ћассив(ќтвет—ервера,);
    	 ƒл€ каждого Ёлементћассива »з –езультатћассив ÷икл
    		
    			 //Ёлемент = —тр«аменить(Ёлемент, "{","");
    			 ≈сли Ќайти(Ёлементћассива,"time") > 0 “огда
    			    ¬рем€ = ѕрав(—окрЋѕ(Ёлементћассива),17); 
			     »наче≈сли Ќайти(Ёлементћассива,"number") > 0 “огда
				    —ообщить(Ёлементћассива);
				    Ёлемент = —тр«аменить(Ёлементћассива, "}","");
				    Ёлемент = —тр«аменить(Ёлемент, "}","");
                    Ёлемент = —тр«аменить(Ёлемент, """","");
				    —ообщить(Ёлемент);
				    Ќомер“елефона = ѕрав(—окрЋѕ(Ёлемент),—трƒлина(Ёлемент)-Ќайти(Ёлемент,":"));
					
			  онец≈сли;

          онец÷икла;
 
		—ообщить("ѕоступил звонок в "+¬рем€ +", от абонента "+Ќомер“елефона);
		
	 	ѕоискјбонента(—окрЋѕ(Ќомер“елефона));
		
		//открываем инф окно
		ќтключитьќбработчикќжидани€("—осто€ниеѕриема");
		‘орма»нформации = Ётотќбъект.ѕолучить‘орму("»нформаци€ онтактногоЋица");
        ‘орма»нформации.ќткрыть();
				ѕодключитьќбработчикќжидани€("—осто€ниеѕриема", “аймаут—екунд);	
		—ообщить("вкл");
	  онец≈сли;
		 
  онецѕроцедуры
       
ѕроцедура ѕоискјбонента(Ќомер“елефона)
   	       –езультатѕоиска—писок.ќчистить();
		«апрос = Ќовый «апрос;
	«апрос.“екст = "¬џЅ–ј“№
				   |	 онтактна€»нформаци€.ќбъект,
				   |	 онтактна€»нформаци€.ѕредставление
				   |»«
				   |	–егистр—ведений. онтактна€»нформаци€  ј   онтактна€»нформаци€
				   |√ƒ≈
				   |	 онтактна€»нформаци€.“ип = &“ип онтактной»нформации";
	«апрос.”становитьѕараметр("“ип онтактной»нформации",ѕеречислени€.“ипы онтактной»нформации.“елефон);
	
	
	–езультат = «апрос.¬ыполнить();
	
	≈сли Ќ≈ –езультат.ѕустой() “огда
		¬ыборка = –езультат.¬ыбрать();
		
		ѕока ¬ыборка.—ледующий() ÷икл
			ЌайденыйЌомер = Ќайти„исло¬—троке(—окрЋѕ(¬ыборка.ѕредставление));
			//≈сли ЌайденыйЌомер = Ќомер“елефона “огда
			≈сли Ќайти(ЌайденыйЌомер,Ќомер“елефона) “огда
				»нформаци€ќ онтактномЋице = ¬ыборка.ќбъект;
				≈сли »нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка() “огда
					 онтактноеЋицо = ¬ыборка.ќбъект; 
					»нформаци€ќ онтактномЋице = ¬ыборка.ќбъект.¬ладелец;
					
				 онец≈сли;
				
				ќбновитьƒанныеќ онтактномЋице(»нформаци€ќ онтактномЋице);
				ѕрервать;
			»наче  
				»нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка();
				—писокЌомеров онтактногоЋица.ќчистить();
			 онец≈сли;

		 онец÷икла;
	
	»наче 
		—ообщить(" онтактное лицо не найдено");
		—писокЌомеров онтактногоЋица.ќчистить();
	 онец≈сли;
	
	≈сли »нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка() “огда
		—ообщить(" онтактное лицо не найдено");
		—писокЌомеров онтактногоЋица.ќчистить();
	 онец≈сли;	

		  

//	 	«апрос = Ќовый «апрос;
//	«апрос.“екст = "¬џЅ–ј“№
//				   |	 онтактна€»нформаци€.ќбъект,
//				   |	 онтактна€»нформаци€.“ип,
//				   |	 онтактна€»нформаци€.¬ид
//				   |»«
//				   |	–егистр—ведений. онтактна€»нформаци€  ј   онтактна€»нформаци€";
//	–езультат = «апрос.¬ыполнить();
//	
//	≈сли Ќ≈ –езультат.ѕустой() “огда
//		¬ыборка = –езультат.¬ыбрать();
//		ѕока ¬ыборка.—ледующий() ÷икл
//			ЌайденыйЌомер = Ќайти„исло¬—троке(—окрЋѕ(¬ыборка.ѕредставление));
//			≈сли ЌайденыйЌомер = Ќомер“елефона “огда
//			≈сли Ќайти(ЌайденыйЌомер,Ќомер“елефона) “огда
//				»нформаци€ќ онтактномЋице = ¬ыборка.ќбъект;
//				≈сли »нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка() “огда
//					 онтактноеЋицо = ¬ыборка.ќбъект; 
//					»нформаци€ќ онтактномЋице = ¬ыборка.ќбъект.¬ладелец;
//				 онец≈сли;
//				
//				ќбновитьƒанныеќ онтактномЋице(»нформаци€ќ онтактномЋице);
//			ѕрервать;
//			»наче  
//				»нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка();
//				   —ообщить(" онтактное лицо не найдено");
//		 —писокЌомеров онтактногоЋица.ќчистить();


//		    онец≈сли;
//					  онец≈сли;
//		 онец÷икла;
//	
//	»наче 
//		—ообщить(" онтактное лицо не найдено");
//		—писокЌомеров онтактногоЋица.ќчистить();
//		
//	 онец≈сли;
//	
//	≈сли »нформаци€ќ онтактномЋице = —правочники. онтрагенты.ѕуста€—сылка() “огда
//		—ообщить(" онтактное лицо не найдено");
//		 —писокЌомеров онтактногоЋица.ќчистить();

//	 онец≈сли;	


 онецѕроцедуры


ѕроцедура ќбновитьƒанныеќ онтактномЋице(»нформаци€ќ онтакте)  	
	       ≈сли Ќ≈ »нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка() “огда
//	ѕопытка
		//»нформаци€ќ онтакте = —правочники. онтрагенты.—оздатьЁлемент();		  
			»нформаци€ќ онтакте.ѕолучитьќбъект();
		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.ќбъект;
		ќтборƒанныхќ онтактномЋице.«начение = »нформаци€ќ онтактномЋице;
		ќтборƒанныхќ онтактномЋице.»спользование = »стина;	
		
		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.“ип;
		ќтборƒанныхќ онтактномЋице.«начение = ѕеречислени€.“ипы онтактной»нформации.“елефон;
		ќтборƒанныхќ онтактномЋице.»спользование = »стина;
	   онец≈сли;

	
	//	≈сли Ќ≈ »нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка() “огда
	////ѕопытка
	//	//»нформаци€ќ онтакте = —правочники. онтрагенты.—оздатьЁлемент();		  
	//		»нформаци€ќ онтакте.ѕолучитьќбъект();
	//	ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.ќбъект;
	//	ќтборƒанныхќ онтактномЋице.«начение = »нформаци€ќ онтакте;
	//	ќтборƒанныхќ онтактномЋице.»спользование = »стина;	
	//	
	//	ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.“ип;
	//	ќтборƒанныхќ онтактномЋице.«начение = ѕеречислени€.“ипы онтактной»нформации.“елефон;
	//	ќтборƒанныхќ онтактномЋице.»спользование = »стина;

			//»нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка()
	
	
		//≈сли Ќ≈ »нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка() “огда

//			 »нформаци€ќ онтакте = —правочники. онтрагенты.ѕолучить—сылку().ѕолучитьќбъект();
//			
//		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.ќбъект;
//		ќтборƒанныхќ онтактномЋице.«начение = »нформаци€ќ онтакте;
//		ќтборƒанныхќ онтактномЋице.»спользование = »стина;	
//		
//		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.“ип;
//		ќтборƒанныхќ онтактномЋице.«начение = ѕеречислени€.“ипы онтактной»нформации.“елефон;
//		ќтборƒанныхќ онтактномЋице.»спользование = »стина;
		  // онец≈сли;


 онецѕроцедуры

ѕроцедура Ќомер“елефонаѕри»зменении(Ёлемент)
	ѕоискјбонента(—окрЋѕ(Ќомер“елефона));
	 онецѕроцедуры

ѕроцедура —трокаѕоискајвтоѕодбор“екста(Ёлемент, “екст, “екстјвтоѕодбора, —тандартна€ќбработка)
	//ѕроцедурыѕоискаѕо—троке.јвтоѕодбор“екста¬Ёлементе”правлени€();
 онецѕроцедуры


ѕроцедура —писокЌомеров онтактногоЋицаѕријктивизации—троки(Ёлемент)
	
	
	//Ќомер“елефона = 	 Ёлементы‘ормы.—писокЌомеров онтактногоЋица.¬ыделенные—троки;
	//	“екуща€—трока = Ёлементы‘ормы.–езультатѕоиска—писок.“екущиеƒанные;  
	//
		 онецѕроцедуры

ѕроцедура ѕри«акрытии()
	ѕопытка
	Ётотќбъект.ѕолучить‘орму("»нформаци€ онтактногоЋица").«акрыть();
»сключение;
	 онецѕопытки;
 онецѕроцедуры

ѕроцедура  онтрагентЌажатие(Ёлемент)
	 онтрагент = —правочники. онтрагенты.ѕолучить‘ормуЌовогоЁлемента("‘ормаЁлемента");
	 онтрагент.ќткрыть();
 онецѕроцедуры

ѕроцедура  онтактноеЋицоЌажатие(Ёлемент)
	 онтЋицо = —правочники. онтактныеЋица.ѕолучить‘ормуЌовогоЁлемента("‘ормаЁлемента");
	 онтЋицо.ќткрыть();
 онецѕроцедуры

 ѕроцедура —оздать—обытиеЌажатие(Ёлемент)
	¬вестиЌовое—обытие(Ћожь, Ќеопределено, ѕеречислени€.¬иды—обытий.“елефонный«вонок);

 онецѕроцедуры
	
ѕроцедура ¬вестиЌовое—обытие( опирование = Ћожь, Ёлемент = Ќеопределено, ¬ыбранный¬ид—обыти€)

	//≈сли Ќ≈ –абота—ƒиалогами.«аписатьЌовыйќбъект¬‘орме(»нформаци€ќ онтактномЋице.ѕолучить‘орму()) “огда
	//	¬озврат;
	// онец≈сли; 

	≈сли  опирование “огда
		≈сли Ёлемент.“екуща€—трока <> Ќеопределено » Ќ≈ Ёлемент.“екуща€—трока.ѕуста€() “огда
			Ёлемент.“екуща€—трока.—копировать().ѕолучить‘орму(,Ёта‘орма).ќткрыть();
		 онец≈сли;
	»наче
		
		≈сли ¬ыбранный¬ид—обыти€ = Ќеопределено “огда
			
			—писок¬ыбора = Ќовый —писок«начений;
			ƒл€ каждого ¬ид—обыти€ »з ѕеречислени€.¬иды—обытий ÷икл
				Ёлемент—писка = —писок¬ыбора.ƒобавить(¬ид—обыти€, —трока(¬ид—обыти€));
				Ёлемент—писка. артинка = ”правление онтактами.ѕолучить артинкуЌапоминани€(¬ид—обыти€);
			 онец÷икла; 

			≈сли Ёлемент <> Ќеопределено » Ёлемент.“екущиеƒанные <> Ќеопределено » Ќ≈ Ёлемент.“екущиеƒанные.—сылка.ѕуста€() “огда
				«начени€ѕоиска¬—писке = Ёлемент.“екущиеƒанные.¬ид—обыти€;
			 онец≈сли;

			ЌайденныйЁлемент—писка = —писок¬ыбора.Ќайтиѕо«начению(«начени€ѕоиска¬—писке);
			¬ыбранныйЁлемент = —писок¬ыбора.¬ыбратьЁлемент("¬ыберите тип документа", ЌайденныйЁлемент—писка);
			
			≈сли ¬ыбранныйЁлемент <> Ќеопределено “огда
				¬ыбранный¬ид—обыти€ = ¬ыбранныйЁлемент.«начение;
			 онец≈сли; 
			
		 онец≈сли; 
		
		≈сли ¬ыбранный¬ид—обыти€ <> Ќеопределено “огда
			
			ƒок = ƒокументы.—обытие.—оздатьƒокумент();
			
			ƒок.¬ид—обыти€     = ¬ыбранный¬ид—обыти€;
			ƒок. онтрагент     = »нформаци€ќ онтактномЋице;
			//ƒок. онтактноеЋицо = »нформаци€ќ онтактномЋице.ќсновное онтактноеЋицо;
			ƒок. онтактноеЋицо =  онтактноеЋицо;
			ƒок.¬идќбъекта     = ѕеречислени€.¬идыќбъектов—обыти€. онтрагент;

			‘орма—обыти€       = ƒок.
			ѕолучить‘орму(,Ёта‘орма);
			
//			Ёлементы‘ормы.ѕанель.“екуща€—траница = Ёлементы‘ормы.ѕанель.—траницы.—обыти€;
			‘орма—обыти€.—труктураќбъект онтрагент = Ќовый —труктура("ќбъект, «аписыватьќбъект", Ётотќбъект, »стина);
			
			‘орма—обыти€.ќткрыть();
			—ообщить("Ќужно ли здесь открывать окно контрагента? (справочник  онтрагенты)");
		 онец≈сли; 
	 онец≈сли; 
	
 онецѕроцедуры

ѕроцедура —писокЌомеров онтактногоЋицаѕријктивизации олонки(Ёлемент)
	// ¬ставить содержимое обработчика.
Ќомер“елефона =Ёлементы‘ормы.—писокЌомеров онтактногоЋица.“екущиеƒанные.ѕредставление;
 онецѕроцедуры

  
ѕроцедура –езультатѕоиска—писокѕријктивизации олонки(Ёлемент)
	//“екуща€—трока = Ёлементы‘ормы.–езультатѕоиска—писок.“екущиеƒанные;  
	//»нформаци€ќ онтактномЋице = “екуща€—трока.ќбъект;
	//»нформаци€ќ онтакте =  “екуща€—трока.ќбъект;

	//ќбновитьƒанныеќ онтактномЋице(»нформаци€ќ онтакте);	
	////
//≈сли Ќ≈ »нформаци€ќ онтакте = —правочники. онтрагенты.ѕуста€—сылка() “огда
//	ѕопытка
//		»нформаци€ќ онтакте = —правочники. онтрагенты.—оздатьЁлемент();		  
//			»нформаци€ќ онтакте.ѕолучитьќбъект();
//		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.ќбъект;
//		ќтборƒанныхќ онтактномЋице.«начение = »нформаци€ќ онтакте;
//		ќтборƒанныхќ онтактномЋице.»спользование = »стина;	
//		
//		ќтборƒанныхќ онтактномЋице = —писокЌомеров онтактногоЋица.ќтбор.“ип;
//		ќтборƒанныхќ онтактномЋице.«начение = ѕеречислени€.“ипы онтактной»нформации.“елефон;
//		ќтборƒанныхќ онтактномЋице.»спользование = »стина;
//	   онец≈сли;
 онецѕроцедуры


ѕроцедура –езультатѕоиска—писокѕријктивизации—троки(Ёлемент)
	 //¬ставить содержимое обработчика.
	 ≈сли Ќе —трокаѕоиска = "" “огда
	“екуща€—трока = Ёлементы‘ормы.–езультатѕоиска—писок.“екуща€—трока;  
	»нформаци€ќ онтактномЋице = “екуща€—трока.ќбъект;
	»нформаци€ќ онтакте =  “екуща€—трока.ќбъект;

	ќбновитьƒанныеќ онтактномЋице(»нформаци€ќ онтакте);	
       онец≈сли;
 онецѕроцедуры

//настройки внешнего вида
ѕроцедура ÷вет‘онаЌажатие(Ёлемент)
	≈сли ‘лажок1 = 0 “огда
	ƒиалог = Ќовый ƒиалог¬ыбора÷вета();
	≈сли ƒиалог.¬ыбрать()“огда
	÷вет‘она = ƒиалог.÷вет;
	ѕанель.÷вет‘она = ÷вет‘она;
	Ёлементы‘ормы.ƒействи€‘ормы.÷вет‘она = ÷вет‘она;
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки =  ÷вет‘она;
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ =  ÷вет‘она;
	  артинка‘она = Ќовый  артинка();
	ѕанель. артинка =  артинка‘она;
	 артинка‘она=Ћожь;
   —охранить«начение("÷вет‘она",÷вет‘она);
	//Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет‘онаЎапки =÷вет‘она+÷вета—тил€.“екст¬торостепеннойЌадписи;
»наче
	ќтказ = »стина ;
	
 онец≈сли;
 
 онец≈сли;
 онецѕроцедуры

ѕроцедура ‘лажок1ѕри»зменении(Ёлемент)
	WSS=Ќовый COMќбъект("WScript.Shell");
	ѕопытка
		≈сли ‘лажок1 = 1 “огда
			 артинка = Ќовый  артинка(WSS.SpecialFolders().Item("AppData")+"background");
			ѕанель. артинка =  артинка;
			ѕанель.÷вет‘она = ÷вета—тил€.÷вет‘она‘ормы;
			Ёлементы‘ормы.ƒействи€‘ормы.÷вет‘она =  ÷вета—тил€.÷вет‘она‘ормы;
			
			Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ = ÷вета—тил€.÷вет‘она‘ормы;
			Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки =÷вета—тил€.÷вет‘она‘ормы; 

			ќбновить();
		 онец≈сли;
		
	»сключение;
		¬озврат;
	 онецѕопытки;
	
 онецѕроцедуры

ѕроцедура ѕоле“екстаЌажатие(Ёлемент)
	ƒиалог = Ќовый ƒиалог¬ыбора÷вета();
	≈сли ƒиалог.¬ыбрать()“огда
	ѕоле“екста = ƒиалог.÷вет;
	
    Ёлементы‘ормы.Ќомер“елефона.÷вет‘онаѕол€ = ѕоле“екста;
	Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет‘онаѕол€ = ѕоле“екста;
	Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет‘онаѕол€ = ѕоле“екста;
	Ёлементы‘ормы.–езультатѕоиска—писок.÷вет‘онаѕол€ = ѕоле“екста;
	Ёлементы‘ормы.¬нутреннийЌомер.÷вет‘онаѕол€ =  ѕоле“екста;
	Ёлементы‘ормы.ѕароль.÷вет‘онаѕол€ = ѕоле“екста;
	Ёлементы‘ормы.—ервер.÷вет‘онаѕол€ =   ѕоле“екста;
	Ёлементы‘ормы.“аймаут—екунд.÷вет‘онаѕол€ =    ѕоле“екста;
	Ёлементы‘ормы.—трокаѕоиска.÷вет‘онаѕол€ = ѕоле“екста;
	Ёлементы‘ормы.ѕользователь—.÷вет‘онаѕол€ = ѕоле“екста;
	Ёлементы‘ормы.ѕоле алендар€1.÷вет‘онаѕол€ = ѕоле“екста;
	
	—охранить«начение("ѕоле“екста", ѕоле“екста);
	 онец≈сли;
 онецѕроцедуры

ѕроцедура ЎрифтЌажатие(Ёлемент)
	ƒиалог = Ќовый ƒиалог¬ыбораЎрифта; 
≈сли ƒиалог.¬ыбрать() “огда 
	¬ыбранныйЎрифт = ƒиалог.Ўрифт; 
	
//мен€ем шрифт объектов телефонии
Ёлементы‘ормы.‘лажок1.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы. онтрагент.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы. онтактноеЋицо.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.¬нутреннийЌомер.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.ƒействи€‘ормы.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.»нформаци€ќ онтактномЋице.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ќадпись¬нутреннийЌомер.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ќадпись»нформаци€ќ онтактномЋице.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.ЌадписьЌомер“елефона.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ќадписьѕароль.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ќадпись—ервер.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ќадпись“аймаут.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ќомер“елефона.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.ќсновныеƒействи€‘ормы.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.ѕароль.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.ѕозвонить.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.ѕоле алендар€1.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.ѕользователь—.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.–езультатѕоиска—писок.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.сек.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.—ервер.Ўрифт =¬ыбранныйЎрифт;
Ёлементы‘ормы.—оздать—обытие.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.—охранить.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.Ўрифт = ¬ыбранныйЎрифт; 
Ёлементы‘ормы.—трокаѕоиска.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.“аймаут—екунд.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.÷вет‘она.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.÷вет–амки.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.÷вет“екста.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ўрифт.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ќайти.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы. артинка‘она.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.‘лажок1.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.—писокЌомеров онтактногоЋица.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.–езультатѕоиска—писок.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.÷вет нопки.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ќастройка÷вета.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.ѕоле“екста.Ўрифт = ¬ыбранныйЎрифт;
Ёлементы‘ормы.Ќадп—оздать.Ўрифт = ¬ыбранныйЎрифт;
  



  
	»наче
	ќтказ = »стина ;

 онец≈сли;
     	—охранить«начение("¬ыбранныйЎрифт",¬ыбранныйЎрифт); 
 онецѕроцедуры

ѕроцедура ÷вет нопкиЌажатие(Ёлемент)
ƒиалог = Ќовый ƒиалог¬ыбора÷вета();
	≈сли ƒиалог.¬ыбрать()“огда
	¬ыбранный÷вет1 = ƒиалог.÷вет;
  
   //ƒаем значение каждому элементу телефонии по выбранному цвету текста и сохран€ем
   Ёлементы‘ормы.Ќомер“елефона.÷вет‘она нопки = ¬ыбранный÷вет1;
   Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет‘она нопки= ¬ыбранный÷вет1;
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет‘онаЎапки= ¬ыбранный÷вет1;
   Ёлементы‘ормы. онтрагент.÷вет‘она нопки = ¬ыбранный÷вет1;
   Ёлементы‘ормы. онтактноеЋицо.÷вет‘она нопки =  ¬ыбранный÷вет1;
   Ёлементы‘ормы.—оздать—обытие.÷вет‘она нопки = ¬ыбранный÷вет1;
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет‘онаЎапки = ¬ыбранный÷вет1;
   Ёлементы‘ормы.—трокаѕоиска.÷вет‘она нопки =  ¬ыбранный÷вет1;
   Ёлементы‘ормы.Ќайти.÷вет‘она нопки =  ¬ыбранный÷вет1;
   Ёлементы‘ормы.÷вет‘она.÷вет‘она нопки =  ¬ыбранный÷вет1;
   Ёлементы‘ормы.÷вет“екста.÷вет‘она нопки = ¬ыбранный÷вет1;
   Ёлементы‘ормы.÷вет–амки.÷вет‘она нопки =   ¬ыбранный÷вет1;
   Ёлементы‘ормы.÷вет нопки.÷вет‘она нопки=  ¬ыбранный÷вет1;
   Ёлементы‘ормы.—охранить.÷вет‘она нопки =    ¬ыбранный÷вет1;
   Ёлементы‘ормы.ѕоле“екста.÷вет‘она нопки =   ¬ыбранный÷вет1;
   Ёлементы‘ормы.Ўрифт.÷вет‘она нопки =   ¬ыбранный÷вет1;
   Ёлементы‘ормы.ѕозвонить.÷вет‘она нопки =  ¬ыбранный÷вет1;
   Ёлементы‘ормы. артинка‘она.÷вет‘она нопки =¬ыбранный÷вет1;
   Ёлементы‘ормы.ѕоле алендар€1.÷вет‘она нопки = ¬ыбранный÷вет1;
 
	
»наче
	ќтказ = »стина ;
 онец≈сли;
     —охранить«начение("¬ыбранный÷вет1",¬ыбранный÷вет1);  	
 онецѕроцедуры

ѕроцедура  артинка‘онаЌажатие(Ёлемент)
	// выбрать картинку дл€ фона телефонии и сохранить ее в папке с телефонией
≈сли ‘лажок1=1  “огда	
		ƒиалог = Ќовый ƒиалог¬ыбора‘айла(–ежимƒиалога¬ыбора‘айла.ќткрытие);
ƒиалог.«аголовок = "¬ыберите фон панели";
ƒиалог.ѕолное»м€‘айла = "";
ƒиалог.ѕредварительныйѕросмотр = »стина;
ƒиалог.‘ильтр = 
"¬се картинки (*.bmp;*.dib;*.rle;*.jpg;*.jpeg;*.tif;*.gif;*.png;*.ico;*.wmf;*.emf)|*.bmp;*.dib;*.rle;*.jpg;*.jpeg;*.tif;*.gif;*.png;*.ico;*.wmf;*.emf|" 
+ "‘ормат bmp (*.bmp;*.dib;*.rle)|*.bmp;*.dib;*.rle|"
+ "‘ормат JPEG (*.jpg;*.jpeg)|*.jpg;*.jpeg|"
+ "‘ормат TIFF (*.tif)|*.tif|"
+ "‘ормат GIF (*.gif)|*.gif|"
+ "‘ормат PNG (*.png)|*.png|"
+ "‘ормат icon (*.ico)|*.ico|"
+ "‘ормат метафайл (*.wmf;*.emf)|*.wmf;*.emf|"; // картинки

≈сли ƒиалог.¬ыбрать() “огда
     артинка‘она = Ќовый  артинка(ƒиалог.ѕолное»м€‘айла,Ћожь);
    ѕанель. артинка =  артинка‘она;
	WSS=Ќовый COMќбъект("WScript.Shell");
		 артинка‘она.«аписать(WSS.SpecialFolders().Item("AppData")+"background");
		
	»наче
	ќтказ = »стина;
	¬озврат;
 онец≈сли;
 онец≈сли;
 онецѕроцедуры

ѕроцедура ÷вет“екстаЌажатие(Ёлемент)
	ƒиалог = Ќовый ƒиалог¬ыбора÷вета();
	≈сли ƒиалог.¬ыбрать()“огда
	¬ыбранный÷вет = ƒиалог.÷вет;
	
    
   //ƒаем значение каждому элементу телефонии по выбранному цвету текста и сохран€ем
   Ёлементы‘ормы.‘лажок1.÷вет“екста = ¬ыбранный÷вет;
   Ёлементы‘ормы. онтактноеЋицо.÷вет“екста нопки = ¬ыбранныйцвет;
   Ёлементы‘ормы. онтрагент.÷вет“екста нопки = ¬ыбранный÷вет;
   Ёлементы‘ормы.¬нутреннийЌомер.÷вет“екстаѕол€= ¬ыбранный÷вет;
   Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет“екстаѕол€= ¬ыбранный÷вет;
   Ёлементы‘ормы.÷вет“екста.÷вет“екста нопки =     ¬ыбранный÷вет;
   Ёлементы‘ормы.Ќадпись¬нутреннийЌомер.÷вет“екста=  ¬ыбранный÷вет;
   Ёлементы‘ормы.Ќадпись»нформаци€ќ онтактномЋице.÷вет“екста=  ¬ыбранный÷вет;
   Ёлементы‘ормы.ЌадписьЌомер“елефона.÷вет“екста=  ¬ыбранный÷вет;
   Ёлементы‘ормы.Ќадписьѕароль.÷вет“екста =  ¬ыбранный÷вет;
   Ёлементы‘ормы.Ќадпись—ервер.÷вет“екста=¬ыбранный÷вет;
   Ёлементы‘ормы.Ќадпись“аймаут.÷вет“екста=  ¬ыбранный÷вет;
   Ёлементы‘ормы.Ќайти.÷вет“екста нопки= ¬ыбранный÷вет;
   Ёлементы‘ормы.Ќомер“елефона.÷вет“екстаѕол€= ¬ыбранный÷вет;
   Ёлементы‘ормы.ѕароль.÷вет“екстаѕол€ =¬ыбранный÷вет; 
   Ёлементы‘ормы.ѕозвонить.÷вет“екста нопки=   ¬ыбранный÷вет;
   Ёлементы‘ормы.ѕоле алендар€1.÷вет“екстаѕол€=    ¬ыбранный÷вет;
   Ёлементы‘ормы.ѕользователь—.÷вет“екстаѕол€=¬ыбранный÷вет;
   
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет“екстаѕол€= ¬ыбранный÷вет;
   Ёлементы‘ормы.сек.÷вет“екста=  ¬ыбранный÷вет;
   Ёлементы‘ормы.—ервер.÷вет“екстаѕол€ =¬ыбранный÷вет; 
   Ёлементы‘ормы.—оздать—обытие.÷вет“екста нопки=  ¬ыбранный÷вет;
   Ёлементы‘ормы.—охранить.÷вет“екста нопки=  ¬ыбранный÷вет;
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет“екстаѕол€= ¬ыбранный÷вет;
   Ёлементы‘ормы.—трокаѕоиска.÷вет“екстаѕол€= ¬ыбранный÷вет;
   Ёлементы‘ормы.“аймаут—екунд.÷вет“екстаѕол€= ¬ыбранный÷вет;
   Ёлементы‘ормы.÷вет‘она.÷вет“екста нопки=  ¬ыбранный÷вет;
   Ёлементы‘ормы.÷вет–амки.÷вет“екста нопки = ¬ыбранный÷вет;
   Ёлементы‘ормы.Ўрифт.÷вет“екста нопки =  ¬ыбранный÷вет;
   Ёлементы‘ормы.ƒействи€‘ормы.÷вет“екста нопки = ¬ыбранный÷вет;
   ѕанель.÷вет“екста = ¬ыбранный÷вет;
   ѕанель.÷вет“екстаѕол€ = ¬ыбранный÷вет;
   Ёлементы‘ормы. артинка‘она.÷вет“екста нопки = ¬ыбранный÷вет;
   Ёлементы‘ормы.‘лажок1.÷вет“екста = ¬ыбранный÷вет;
   Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет“екстаЎапки=¬ыбранный÷вет;
   Ёлементы‘ормы.–езультатѕоиска—писок.÷вет“екстаЎапки = ¬ыбранный÷вет;
   Ёлементы‘ормы.ѕоле алендар€1.÷вет“екста нопки = ¬ыбранный÷вет;
   Ёлементы‘ормы.÷вет нопки.÷вет“екста нопки = ¬ыбранный÷вет;
	Ёлементы‘ормы.Ќастройка÷вета.÷вет“екста = ¬ыбранный÷вет;
Ёлементы‘ормы.ѕоле“екста.÷вет“екста нопки= ¬ыбранный÷вет;
Ёлементы‘ормы.Ќадп—оздать.÷вет“екста = ¬ыбранный÷вет;

	
	
	 	 
	»наче
	ќтказ = »стина ;
 онец≈сли;
     —охранить«начение("¬ыбранный÷вет",¬ыбранный÷вет);  
  онецѕроцедуры
 
ѕроцедура ÷вет–амкиЌажатие(Ёлемент)
	ƒиалог = Ќовый ƒиалог¬ыбора÷вета();
	≈сли ƒиалог.¬ыбрать()“огда
    ÷вет–амки = ƒиалог.÷вет;
  
	//мен€ем цвет рамок объектов
	Ёлементы‘ормы.¬нутреннийЌомер.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.»нформаци€ќ онтактномЋице.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.Ќомер“елефона.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.ѕароль.÷вет–амки =÷вет–амки; 
	Ёлементы‘ормы.–езультатѕоиска—писок.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.—ервер.÷вет–амки =÷вет–амки; 
	Ёлементы‘ормы.—писокЌомеров онтактногоЋица.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.—трокаѕоиска.÷вет–амки=÷вет–амки;
	Ёлементы‘ормы.“аймаут—екунд.÷вет–амки= ÷вет–амки;
	ѕанель.÷вет–амки= ÷вет–амки;
	Ёлементы‘ормы.–амка√руппы1.÷вет–амки = ÷вет–амки;
	Ёлементы‘ормы.–амка√руппы2.÷вет–амки = ÷вет–амки;
	
   
	 
	   
	»наче
	ќтказ = »стина ;
 онец≈сли;
    —охранить«начение("÷вет–амки",÷вет–амки);
 онецѕроцедуры
